language: node_js

git:
  depth: false

branches:
  only:
  - develop

before_install:
  - sudo apt-get install -y python-pygments

install:
  - wget https://github.com/gohugoio/hugo/releases/download/v0.50/hugo_0.50_Linux-64bit.deb -O /tmp/hugo.deb && sudo dpkg -i /tmp/hugo.deb
  # Clean and don't fail
  - rm -rf public || exit 0

script:
  - hugo --minify

deploy:
  provider: pages
  skip-cleanup: true
  github-token: $GITHUB_TOKEN  # Set in the settings page of your repository, as a secure variable
  keep-history: true
  on:
    branch: master
